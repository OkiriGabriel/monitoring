groups:
  - name: riders_api_alerts
    interval: 30s
    rules:
      - alert: RidersAPIDown
        expr: probe_success{job="blackbox"} == 0
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "Riders API is down"
          description: "{{ $labels.instance }} has been down for more than 2 minutes."

      - alert: RidersAPISlowResponse
        expr: probe_http_duration_seconds{job="blackbox"} > 2
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Riders API slow response time"
          description: "{{ $labels.instance }} response time is {{ $value }}s (threshold: 2s)."

      - alert: RidersAPIHighErrorRate
        expr: rate(probe_success{job="blackbox"}[5m]) < 0.95
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Riders API high error rate"
          description: "{{ $labels.instance }} success rate is below 95%."

      - alert: RidersAPISSLCertExpiringSoon
        expr: probe_ssl_earliest_cert_expiry{job="blackbox"} - time() < 86400 * 30
        for: 1h
        labels:
          severity: warning
        annotations:
          summary: "SSL certificate expiring soon"
          description: "{{ $labels.instance }} SSL certificate expires in less than 30 days."
